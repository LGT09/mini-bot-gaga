<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MINI BOT - Pair & Info</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/css/intlTelInput.css"/>

<style>
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:flex-start;
  padding-top:30px;
  background: linear-gradient(-45deg, #4a90e2, #3ac569, #9b59b6, #e74c3c);
  background-size: 400% 400%;
  animation: gradient 10s ease infinite;
  font-family:Segoe UI, sans-serif;
  color:#fff;
  flex-direction: column;
  align-items: center;
}

@keyframes gradient {
  0% {background-position:0% 50%;}
  50% {background-position:100% 50%;}
  100% {background-position:0% 50%;}
}

.container{
  text-align:center;
  margin-bottom:20px;
  padding:20px;
  border-radius:15px;
  backdrop-filter:blur(10px);
  background: rgba(0,0,0,0.3);
}

h2{
  margin-bottom:10px;
  font-size:2em;
  text-shadow:0 0 10px #fff,0 0 20px #f0f,0 0 30px #0ff;
}

.info-box{
  margin:10px 0;
  padding:15px;
  border-radius:10px;
  background: rgba(255,255,255,0.1);
  animation: rgbText 5s linear infinite;
}

@keyframes rgbText {
  0% {text-shadow: 0 0 5px #ff0000;}
  25% {text-shadow: 0 0 5px #00ff00;}
  50% {text-shadow: 0 0 5px #0000ff;}
  75% {text-shadow: 0 0 5px #ff00ff;}
  100% {text-shadow: 0 0 5px #ff0000;}
}

/* Pair Code Box */
.pair-box{
  width:350px;
  padding:25px;
  border-radius:18px;
  background:rgba(0,0,0,0.8);
  backdrop-filter:blur(15px);
  text-align:center;
  box-shadow:0 0 20px #00ffff,0 0 60px #ff00ff;
  animation:neon 3s infinite alternate;
  margin-bottom:20px;
}

@keyframes neon{
  from{box-shadow:0 0 15px #00ffff;}
  to{box-shadow:0 0 45px #ff00ff;}
}

input{
  width:100%;
  padding:14px;
  border:none;
  border-radius:12px;
  font-size:16px;
  outline:none;
  margin-top:10px;
}

button{
  width:100%;
  margin-top:15px;
  padding:14px;
  border:none;
  border-radius:12px;
  font-weight:bold;
  letter-spacing:3px;
  cursor:pointer;
  background:linear-gradient(135deg,#00ffff,#ff00ff);
  color:#000;
  transition:.3s;
}

button:hover{
  background:linear-gradient(135deg,#00ff00,#ffff00);
  transform:scale(1.05);
}

#pair{
  margin-top:15px;
  font-weight:bold;
}

/* WhatsApp Help Button */
.help-button{
  width:100%;
  padding:14px;
  margin-top:15px;
  border:none;
  border-radius:12px;
  font-weight:bold;
  letter-spacing:2px;
  cursor:pointer;
  background:linear-gradient(45deg,#25D366,#128C7E);
  color:#000;
  transition:.3s;
  text-decoration:none;
  display:inline-block;
}
.help-button:hover{
  background:linear-gradient(45deg,#1ebe5d,#0f7850);
  transform:scale(1.05);
}

/* intl-tel-input dark theme */
.iti__country-list{
  background:#111;
  color:#fff;
}
.iti__country:hover{
  background:#222;
}
.iti__search-input{
  background:#000;
  color:#00ffff;
  border:1px solid #00ffff;
}
</style>
</head>

<body>

<div class="container">
  <h2>MANISHA-MD-MINI-BOT</h2>

  <div class="info-box">
    <strong>Device Info:</strong>
    <p id="deviceInfo">Loading...</p>
  </div>

  <div class="info-box">
    <strong>Battery Health:</strong>
    <p id="batteryHealth">Loading...</p>
  </div>

  <!-- WhatsApp Help Button -->
  <a href="https://wa.me/94759934522" class="help-button" target="_blank">
    HELP
  </a>
</div>

<!-- Pair Code System -->
<div class="pair-box">
  <i class="fa-solid fa-robot fa-2x"></i>
  <h3>∞ Link with phone number ∞</h3>
  <h6>Country Search Enabled</h6>

  <input id="phone" type="tel">
  <button id="submit">ENTER</button>

  <div id="pair"></div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.0.0-alpha.1/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/intlTelInput.min.js"></script>

<script>
// --- Device Info ---
const deviceInfoEl = document.getElementById('deviceInfo');
deviceInfoEl.textContent = `Platform: ${navigator.platform}, Browser: ${navigator.userAgent}`;

// --- Battery Health ---
const batteryEl = document.getElementById('batteryHealth');
if (navigator.getBattery) {
  navigator.getBattery().then(battery => {
    function updateBattery() {
      const level = Math.round(battery.level * 100) + "%";
      const charging = battery.charging ? "Charging" : "Not Charging";
      batteryEl.textContent = `${level} (${charging})`;
    }
    updateBattery();
    battery.addEventListener('levelchange', updateBattery);
    battery.addEventListener('chargingchange', updateBattery);
  });
} else {
  batteryEl.textContent = "Battery API not supported.";
}

// --- Pair Code System ---
const phoneInput = intlTelInput(document.querySelector("#phone"), {
  allowDropdown: true,
  separateDialCode: true,
  nationalMode: false,
  initialCountry: "auto",
  preferredCountries: ["lk","in","us","gb"],
  utilsScript:
    "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.19/js/utils.js"
});

const submit = document.getElementById("submit");
const pair = document.getElementById("pair");

submit.addEventListener("click", async () => {
  if (!phoneInput.isValidNumber()) {
    pair.innerHTML = "<span style='color:yellow'>❗ Invalid phone number</span>";
    return;
  }

  const number = phoneInput.getNumber().replace("+","");

  pair.innerHTML = "<span style='color:#00ffff'>Please wait...</span>";

  try{
    let { data } = await axios(`/code?number=${number}`);
    let code = data.code || "Service Unavailable";

    pair.innerHTML = `
      <div id="copy" onclick="copyCode()" style="cursor:pointer;color:#00ff00">
        CODE: <b>${code}</b><br><small>(click to copy)</small>
      </div>
    `;
  }catch{
    pair.innerHTML = "<span style='color:red'>Server error</span>";
  }
});

function copyCode(){
  const el = document.getElementById("copy");
  navigator.clipboard.writeText(el.innerText.replace("CODE:",""));
  el.innerHTML = "COPIED ✅";
}
</script>

</body>
</html>
 